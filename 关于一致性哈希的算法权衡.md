# 关于一致性哈希的算法权衡

##### By [dgryski](https://medium.com/@dgryski) | [原文链接](https://medium.com/@dgryski/consistent-hashing-algorithmic-tradeoffs-ef6b8e2fcae8)


现在有个问题。我有一个key-value键值对的集合。同时我有一些服务器来存储键值对。它门可以是memcached，Redis，MySQL等。我想将这些key分布在这些服务器上面，为了我能够再找到它们。我不想通过存储整个结构来实现。

一个解决方案叫做对N取模哈希。

首先，选择一个哈希函数来建立一个key（字符串）到一个整数的映射。你的哈希函数计算要快。这趋向于排除加密的那一类函数，例如[SHA-1](https://en.wikipedia.org/wiki/SHA-1) 或[MD5](https://en.wikipedia.org/wiki/MD5)。用它们可以做到分布比较均匀，但是计算的成本太高了。还有一些成本较低的可以选择。像[MurmurHash](https://en.wikipedia.org/wiki/MurmurHash)也不错，但是只比上面那一类好一点而已。非加密哈希函数像xxHash，MetroHash或者SipHash1-3都可以选择。

如果你有N个服务器，你用哈希函数来哈希你的key，然后将整数的结果对N取模。

`
server := serverList[Hash(key) % N]
`

这种做法有很多好处。首先，它非常容易理解。同时它的计算成本不高。取模运算计算的成本高，但是相对于对key的哈希，成本肯定是小的多了。如果你的N（服务器个数）是2的幂次方，那你只需取低位字节。

ps：读原文很流畅，但是翻译是按句来翻译，有点吃力。我感觉是原文的作者写的太口语化了，或者说不严谨。